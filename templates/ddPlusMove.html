<!DOCTYPE html>
<html lang="ja">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>プログラム学習システム</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            color: #CECFD3;
        }

        body {
            background-size: cover;
            background: #3B3F42;
            -webkit-user-select: none;
        }

        select:focus, button:focus {
            outline: 1px;
            border-color: white;
        }

        option {
            color: #1E1E1E;
        }

        div {
            display: block;
        }

        #headline {
            width: 100%;
            height: 10px;
            background-color: rgb(79, 79, 79);
            border-bottom: solid 1px gray;
        }

        #title {
            margin: 1px;
            padding: 20px;
            border-top: double 2px darkgray;
            border-bottom: double 2px darkgray;
            background: linear-gradient(
                    to bottom,
                    #525252 0%,
                    #272727 50%,
                    #1c1c1c 90%);
            box-shadow: 2px 2px 5px #000;
            font-family: "メイリオ";
        }

        .select {
            padding:10px 10px 12px 10px;
            border-top: solid 2px white;
            border-left: solid 2px white;
            border-bottom: solid 2px gray;
            border-right: solid 2px gray;
            position: relative;
            display: inline-block;
            background: #202020;
            background: linear-gradient(
                    to bottom,
                    #525252 0%,
                    #272727 70%,
                    #1c1c1c 100%);
            box-shadow: 2px 2px 5px #000;
            border-radius: 6px;
            text-shadow: 0 -1px rgba(206, 207, 211, 0.12);

        }

        .select select * {
            background: #242424;
            color: #fff;
            text-shadow: none;
        }

        .select select:focus {
            text-shadow: 0 0 1px #b5b5b5;
        }

        .select select * {
            background: #242424;
            color: #fff;
            text-shadow: none;
        }

        option {
            padding: 16px;
            background: #eeeeee;
        }

        #wrapper {
            width: 700px;
            margin: 0 0%;
        }

        #codeSpace {
            position: absolute;
            top: 158px;
            left: 50px;
            z-index: 0;
        }

        #upperTop {
            position: relative;
            top: 0;
            left: 50px;
        }

        #upper {
            position: relative;
            top: 0;
            left: 0;
            width: 623px;
            height: 150px;
            padding-top: 2em;
            padding-left: 0.5em;
            padding-right: 0em;
            padding-bottom: 3em;
            border: 1px solid #ddd;
            background: #3B3F42;
            overflow-y: scroll;
            display: -webkit-box;
            -webkit-box-orient: vertical;
        }

        #upper > img{
            margin-right: 1em;
        }

        .sidePoint {
            width: 49px;
            background: #141414;
            height: 480px;
            border-right: solid #dddddd 1px;
            overflow-x: scroll;
        }

        #spBack {
            position: absolute;
            top: 285px;
            left: 0;
        }

        #sidePoint {
            position: absolute;
            top: 285px;
            left: 0;
            background-image: url("{% static  'img/midDrop.png' %}");
            background-position-y: 35px;
            background-repeat: no-repeat;
        }

        #bottomBack {
            background: #1E1E1E;
            width: 552px;
            padding-top: 2em;
            padding-right: 2em;
            padding-bottom: 3em;
            position: absolute;
            top: 285px;
            left: 50px;
            height: 400px;
            z-index: -10;
            overflow: scroll;
        }

        #buttons {
            position: absolute;
            top: 236px;
            left: 0;
        }

        #bottom {
            position: absolute;
            top: 285px;
            left: 50px;
            height: 400px;
            width: 552px;
            padding-top: 2em;
            padding-right: 2em;
            padding-bottom: 3em;
            z-index: 20;
            overflow: scroll;
        }

        #bottom img, #bottom div {
            border: dashed 1px rgba(0, 0, 0, 0.8);
            border-radius: 20px;
            height: auto;
            max-width: 100%;
            display: block;
        }

        .arrows-rl {
            width: 115px;
            height: 90px;
        }

        .arrows-tb {
            width: 90px;
            height: 115px;
        }

        #backCvs, #cvs {
            border: solid 1px black;
            position: absolute;
            top: 0;
            left: 0;
        }

        #backCvs {
            background: rgba(255, 0, 0, 0.2);
        }

        #cvs {
            background: rgba(0, 255, 255, 0.2);
        }

        #news {
            position: relative;
            top: 6px;
            left: 326px;
            width: 70px;
            height: 70px;
        }

        #upper > .divCode {
            border: solid 1px black;
        }

        .divCode {
            width: 250px;
            height: 23px;
            padding-top: 5px;
            padding-left: 5px;
            padding-bottom: 5px;
            font-size: 20px;
        }

        #helpWindow {
            position: absolute;
            background: #202020;
            background: linear-gradient(
                    to bottom,
                    #525252 0%,
                    #272727 70%,
                    #2c2c2c 100%);

            border-top: solid 2px white;
            border-left: solid 2px white;
            border-bottom: solid 2px gray;
            border-right: solid 2px gray;
            padding: 25px;
            top: 20px;
            left: 150px;
            z-index: 5;
            border-radius: 6px;
            box-shadow: 2px 2px 15px #000;
        }

        #CloseBtn {
            position: absolute;
            top: -25px;
            left: 500px;
            z-index: 10;
            padding: 0 10px;
            margin: 0;
            box-shadow: 2px 0 5px #000;
        }

        .batu {
            font-size: 40px;
        }

        #helpBtn {
            position: relative;
            top: 6px;
            left: 50px;
            width: 116px;
            font-size: 14px;
            text-decoration: none;
            display: block;
            text-align: center;
            padding: 8px 0 10px;
            color: #e8e8e8;
            border-radius: 6px;
            text-shadow: 0 -1px rgba(206, 207, 211, 0.12);
            background: #202020;
            background: linear-gradient(
                    to bottom,
                    #525252 0%,
                    #272727 70%,
                    #1c1c1c 100%);
            box-shadow: 2px 2px 5px #000;
        }

        .button {
            padding: 10px;
            color: #e8e8e8;
            border-radius: 6px;
            text-shadow: 0 -1px rgba(206, 207, 211, 0.12);
            background: #202020;
            background: linear-gradient(
                    to bottom,
                    #525252 0%,
                    #272727 70%,
                    #1c1c1c 100%);
            box-shadow: 2px 2px 5px #000;
        }

        .resetBtn {
            padding: 10px 30px;
        }

        #actionSide {
            position: relative;
            top: 100px;
            left: 694px;
        }

        .actionBtn {
            padding: 40px 8px;
            margin-top: 104px;
        }

        #actionSpace {
            float: right;
            position: absolute;
            top: 130px;
            left: 750px;
        }

        .saisei {
            font-size: 30px;
            color: rgba(255, 255, 255, 1);
        }

        #actionUnder {
            position: relative;
            top: 136px;
            left: 750px;
        }
        #characters{
            position: relative;
            top:0;
            left:0;
        }

        #cvsReset{
            position: relative;
            top:-1px;
            left:0
        }
    </style>
    <script type="text/javascript">
        /**
         * 外部jsファイルではsrcを取得することが出来ないため、html内で取得
         */
        var lemSrc = "{% static 'img/lemmini.png' %}";
        var akitoSrc = "{% static 'img/akito40.png' %}";
        var t26e5Src = "{% static 'img/t26e5mini.png' %}";
        var mainImageSrc = "{% static 'img/akito40.png' %}";
        var masaruSrc = "{% static 'img/masaru.png' %}";
        var tyagumaSrc = "{% static 'img/tyaguma.png' %}";
        var sunagauoSrc = "{% static 'img/sunagafish.png' %}";
        var block_b2Src = "{% static 'img/block_b2.png' %}";
        var block_bSrc = "{% static 'img/block_b.png' %}";
        var haikeiSrc = "{% static 'img/kusamura.jpg' %}";
        var goalSrc = "{% static 'img/goalFlag.png' %}";
        var ebataSrc = "{% static 'img/ebata.jpg' %}";
        var dragSoundSrc = "{% static 'audio/switch01.mp3' %}";
        var ifBreakSrc = "{% static 'img/if_brake.png' %}";
        var midDropSrc = "{% static 'img/midDrop.png' %}";
        var whileStr2Src = "{% static 'img/whileStr2.png' %}";
        var whileStr3Src = "{% static 'img/whileStr3.png' %}";
        var whileStr4Src = "{% static 'img/whileStr4.png' %}";
        var forward1Src = "{% static 'img/forward1.png' %}";
        var forward2Src = "{% static 'img/forward2.png' %}";
        var forward3Src = "{% static 'img/forward3.png' %}";
        var forward4Src = "{% static 'img/forward4.png' %}";
        var turnEastSrc = "{% static 'img/turnEast.png' %}";
        var turnWestSrc = "{% static 'img/turnWest.png' %}";
        var turnSouthSrc = "{% static 'img/turnSouth.png' %}";
        var turnNorthSrc = "{% static 'img/turnNorth.png' %}";
        /**
         * サーバー側から送信されるデータを取得
         */
        var mapData = {{ mapData|safe }};// mapデータ（二次元配列） 文字化け対策で |safe
        var block_size = {{ block_size }};// 1つあたりのブロックの大きさ(正方形想定)
        var cvs_width = {{ cvs_width }};
        var cvs_height = {{ cvs_height }};
        var pPositionX = {{ pPositionX }};// プレイヤー初期X座標
        var pPositionY = {{ pPositionY }};// プレイヤー初期Y座標
    </script>
    {% csrf_token %}
</head>
<body onselectstart="return false">
<div id="headline"></div>
<h1 id="title">プログラム学習用Webアプリ</h1>
<div id="wrapper">
    <button id="helpBtn" class="button" onclick="OpenHelp()">操作方法</button>
    <div id="upperTop">
        <div id="helpWindow">
            <h3>操作説明：</h3><br/>
            <p>コードボックス内のコードをドラッグして</br>エディター内にドロップするとプログラムを組む事ができます。</p><br/>
            <ul>
                <li>左クリック：コードの値を変更する（例：繰り返し回数:2 → 3）</li>
                <li>右クリック：コードボックスにコードを戻す</li>
            </ul>
            <button id="CloseBtn" class="button" onclick="CloseHelp()"><span class="batu">×</span></button>
        </div>
        <script type="text/javascript">
            // ヘルプメッセージデフォルト非表示
            document.getElementById("helpWindow").style.display = "none";
        </script>
    </div>
    <!-- codeSpace
    概要 :
            擬似コード,各種ボタン（移動予定）擬似プログラムエディターの配置をするdiv codeSpace
            配置はcssのposition absoluteで設定
            img,divによるコードに設定するデータは 　data-d = 方向データ,特殊：while = "w" if = "i"
               　　　　　　　　　　　　　　　　　　　data-n = whileなら繰り返し回数、その他の場合 1を指定

            例：<img src="url" class="arrows-tb" id="arBottom" draggable="true" data-d="b"
                 data-n="1" ondragstart="f_dragstart(event)">

                 設定されている情報：ドラッグ可能 , 方向：下(Bottom) , 値：1 (条件文ではない)
     -->
    <div id="codeSpace">
        <div id="upper" ondragover="f_dragover(event)" ondrop="f_drop(event)">
            <input type="hidden" id="endWhile" data-d="e" data-n="0">
            <img src="{% static 'img/forward1.png' %}" id="forward_1" onclick="forwardImageOnClick(this)"
                 draggable="true"
                 data-n="1" ondragstart="f_dragstart(event)">
            <img src="{% static 'img/forward1.png' %}" id="forward_2" onclick="forwardImageOnClick(this)"
                 draggable="true"
                 data-n="1" ondragstart="f_dragstart(event)">
            <img src="{% static 'img/forward1.png' %}" id="forward_3" onclick="forwardImageOnClick(this)"
                 draggable="true"
                 data-n="1" ondragstart="f_dragstart(event)">
            <img src="{% static 'img/forward1.png' %}" id="forward_4" onclick="forwardImageOnClick(this)"
                 draggable="true"
                 data-n="1" ondragstart="f_dragstart(event)">
            <img src="{% static 'img/turnNorth.png' %}" id="turn_n" draggable="true" data-d="t"
                 ondragstart="f_dragstart(event)" onclick="directionImageOnClick(this)">
            <img src="{% static 'img/turnEast.png' %}" id="turn_e" draggable="true" data-d="r"
                 ondragstart="f_dragstart(event)" onclick="directionImageOnClick(this)">
            <img src="{% static 'img/turnSouth.png' %}" id="turn-s" draggable="true" data-d="b"
                 ondragstart="f_dragstart(event)" onclick="directionImageOnClick(this)">
            <img src="{% static 'img/turnWest.png' %}" id="turn-w" draggable="true" data-d="l"
                 ondragstart="f_dragstart(event)" onclick="directionImageOnClick(this)">
            <!--
            <img src="{% static 'img/arrowT.png' %}" class="arrows-tb" id="arTop" draggable="true" data-d="t"
                 data-n="1" ondragstart="f_dragstart(event)">
            <img src="{% static 'img/arrowR.png' %}" class="arrows-rl" id="arRight" draggable="true" data-d="r"
                 data-n="1" ondragstart="f_dragstart(event)">
            <img src="{% static 'img/arrowB.png' %}" class="arrows-tb" id="arBottom" draggable="true" data-d="b"
                 data-n="1" ondragstart="f_dragstart(event)">
            <img src="{% static 'img/arrowL.png' %}" class="arrows-rl" id="arLeft" draggable="true" data-d="l"
                 data-n="1" ondragstart="f_dragstart(event)">
            <div id="sample" class="divCode" draggable="true" data-d="t" data-n="1"
                 ondragstart="f_dragstart(event)">sample</div>
            <img src="{% static 'img/base.png' %}" class="arrows-wh" id="While" draggable="true" data-d="w"
                 data-n="3" ondragstart="f_dragstart(event)">
            <img src="{% static 'img/if_brake.png' %}" class="arrows-wh" id="if_break" draggable="true" data-d="i"
                 data-n="1" ondragstart="f_dragstart(event)">
            -->
            <img src="{% static 'img/whileStr2.png' %}" class="arrows-wh" id="While2" onclick="whileImageOnClick(this)"
                 draggable="true" data-d="w"
                 data-n="2" ondragstart="f_dragstart(event)">
            <img src="{% static 'img/whileStr2.png' %}" class="arrows-wh" id="While3" onclick="whileImageOnClick(this)"
                 draggable="true" data-d="w"
                 data-n="2" ondragstart="f_dragstart(event)">
            <img src="{% static 'img/whileStr2.png' %}" class="arrows-wh" id="While4" onclick="whileImageOnClick(this)"
                 draggable="true" data-d="w"
                 data-n="2" ondragstart="f_dragstart(event)">
        </div>
        <div id="buttons">
            <button class="button" onclick="debug()" >デバッグ表示</button>
            <button class="button resetBtn" onclick="resetImages();">コードボックスのリセット</button>
            <button class="button resetBtn" onclick="allReset();">全部リセット</button>
        </div>
        <div id="spBack" class="sidePoint"></div>
        <div id="sidePoint" class="sidePoint"></div>
        <div id="bottomBack"></div>
        <div id="bottom" ondragover="f_dragover(event)" ondrop="f_drop(event)"
             onscroll="document.getElementById('bottomBack').scrollTop = this.scrollTop;"></div>
    </div>
    <div id="actionSide">
        <button id="actionBtn" class="button actionBtn" onclick="actionBtnOnClick()">実行<br/><span
                class="saisei">▶</span></button>
    </div>
    <!-- actionSpace
        概要 :
               背景用canvas：backCvs　と　表面動作確認用canvas：cvs の二つで構成されているdiv actionSpace
                それぞれ width,heightはPython側のconfig.iniファイルで設定
                配置はcssのposition absoluteで設定
         -->
    <div id="actionSpace">
        <canvas id="backCvs" width="{{ cvs_width }}px" height="{{ cvs_height }}px"></canvas>
        <canvas id="cvs" width="{{ cvs_width }}px" height="{{ cvs_height }}px"></canvas>
        <img id="news" src="{% static 'img/news.png' %}"/>
    </div>
    <div id="actionUnder">
        <select id="characters" class="select" name="characters" onchange="changeCharacter()">
            <option value="">キャラクター選択</option>
            <option value="">れむりん</option>
            <option value="">あきとくん</option>
            <option value="">勝君</option>
            <option value="">茶熊</option>
            <option value="">須永魚</option>
            <option value="">若いEBT</option>
        </select>
        <button id="cvsReset" class="button resetBtn" onclick="cvsReset();">動作画面のリセット</button>
    </div>
    <script type="text/javascript" src="{% static 'js/ddPlusMoveBack.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/click.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/ddPlusMove.js' %}"></script>
    <a href="{% url 'algApp:index' %}">TOP</a>
</div>
</body>
</html>